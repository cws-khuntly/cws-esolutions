<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <security-config>
        <email-address>secadm@caspersbox.com</email-address>
        <otpVariance>3</otpVariance> <!-- maximum drift for otp authentication -->
        <maxAttempts>3</maxAttempts> <!-- maximum number of failed authentication attempts -->
        <iterations>65535</iterations> <!-- number of times to hash over the password -->
        <passwordExpiration>90</passwordExpiration> <!-- how long before a password MUST be changed -->
        <passwordMinLength>8</passwordMinLength> <!--  minimum allowed password length -->
        <passwordMaxLength>64</passwordMaxLength> <!--  maximum allowed password length (0 or null -> no limit)-->
        <authAlgorithm>SHA-512</authAlgorithm> <!-- MessageDigest: http://docs.oracle.com/javase/6/docs/technotes/guides/security/StandardNames.html#MessageDigest -->
        <otpAlgorithm>HmacSHA1</otpAlgorithm> <!-- otp hash algorithm -->
        <saltLength>64</saltLength> <!-- salt string length (bigger is better) -->
        <performAudit>true</performAudit> <!-- should we audit stuff ? (default true) -->
        <resetIdLength>64</resetIdLength> <!-- reset id length (bigger is better) -->
        <smsResetEnabled>false</smsResetEnabled> <!-- do we send the reset email AND an sms ? -->
        <smsCodeLength>8</smsCodeLength> <!-- how long should the sms reset id be ? -->
        <resetTimeout>30</resetTimeout> <!-- reset timeout length (minutes) -->
        <authConfig>/opt/cws/eSolutions/etc/repository.properties</authConfig>
        <authManager>com.cws.esolutions.security.dao.userauth.impl.LDAPAuthenticator</authManager>
        <userManager>com.cws.esolutions.security.dao.usermgmt.impl.LDAPUserManager</userManager>
    </security-config>

    <!-- this should correlate back to the data obtained from -->
    <!-- the authentication repository. the objects below -->
    <!-- are the *minimum* required to populate the user object -->
    <auth-data>
        <entryName>cn</entryName> <!-- need this -->
        <entryName>uid</entryName> <!-- need this -->
        <entryName>userPassword</entryName> <!-- this is ONLY used during authentication. it is NOT kept in memory -->
        <entryName>cwsfailedpwdcount</entryName> <!-- need this -->
        <entryName>cwsexpirydate</entryName> <!-- need this -->
        <entryName>cwslastlogin</entryName> <!-- need this -->
        <entryName>sn</entryName> <!-- need this -->
        <entryName>givenName</entryName> <!-- need this -->
        <entryName>displayName</entryName> <!--  we could remove this and just use the surname, but what if someone wants a different display ? -->
        <entryName>email</entryName> <!-- need this -->
        <entryName>cwssecq1</entryName> <!-- only used for authentication (specifically, an online reset) -->
        <entryName>cwssecq2</entryName> <!-- only used for authentication (specifically, an online reset) -->
        <entryName>cwssecans1</entryName> <!-- only used for authentication (specifically, an online reset) -->
        <entryName>cwssecans2</entryName> <!-- only used for authentication (specifically, an online reset) -->
        <entryName>cwsissuspended</entryName> <!-- need this -->
        <entryName>cwsisolrsetup</entryName> <!-- only used for authentication (specifically, an online reset) -->
        <entryName>cwsisolrlocked</entryName> <!-- only used for authentication (specifically, an online reset) -->
        <entryName>cwspublickey</entryName> <!-- only used during file signature operations. not used any other time and not stored during auth -->
        <entryName>pager</entryName> <!-- need this -->
        <entryName>telephoneNumber</entryName> <!-- need this -->
        <entryName>cwssecretkey</entryName>
    </auth-data>

    <!-- only required if file-based signing is used. the keys arent used for anything else. -->
    <key-config>
        <keyAlgorithm>RSA</keyAlgorithm> <!-- keygen algorithm -->
        <keySize>4096</keySize> <!-- if algorithm is DSA, this MUST be 1024: http://docs.oracle.com/javase/6/docs/technotes/guides/security/SunProviders.html -->
        <keyDirectory>/opt/eSolutions/keys</keyDirectory> <!-- this is ONLY required if you're using a file-based keymanager -->
        <keyManager>com.cws.esolutions.security.keymgmt.impl.LDAPKeyManager</keyManager>
    </key-config>

    <!-- only required if file-based signing is used. if this is configured then key-config MUST be configured. -->
    <file-security-config>
        <signatureAlgorithm>SHA1withRSA</signatureAlgorithm> <!-- file signature algorithm -->
        <encryptionAlgorithm>RSA</encryptionAlgorithm> <!-- file encryption algorithm -->
    </file-security-config>

    <exception-config>
        <sendExceptionNotifications>false</sendExceptionNotifications> <!-- if true, configure mail props -->
    </exception-config>

    <resource-config>
        <DataSourceManager>
            <dsName>SecurityDataSource</dsName>
            <datasource>jdbc:mysql://127.0.0.1/cwssec?autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull</datasource>
            <driver>com.mysql.jdbc.Driver</driver>
            <dsUser>appuser</dsUser>
            <dsPass>TrUqoyr4N3KXK8Ivd9jcZ1fXPy00JRe5xNFiaOEUVQU=</dsPass>
            <salt>OITltocOUZjW</salt>
        </DataSourceManager>
        <DataSourceManager>
            <dsName>AuditDataSource</dsName>
            <datasource>jdbc:mysql://127.0.0.1/cwssec?autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull</datasource>
            <driver>com.mysql.jdbc.Driver</driver>
            <dsUser>appuser</dsUser>
            <dsPass>TrUqoyr4N3KXK8Ivd9jcZ1fXPy00JRe5xNFiaOEUVQU=</dsPass>
            <salt>OITltocOUZjW</salt>
        </DataSourceManager>
    </resource-config>
</configuration>
