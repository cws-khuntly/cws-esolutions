# OpenSSL example configuration file.
# This is mostly being used for generation of certificate requests.
#
# This definition stops the following lines choking if HOME isn't
# defined.
HOME                           = .
RANDFILE                       = $ENV::HOME/.rnd
oid_section                    = new_oids

[ new_oids ]
tsa_policy1                    = 1.2.3.4.1
tsa_policy2                    = 1.2.3.4.5.6
tsa_policy3                    = 1.2.3.4.5.7

[ ca ]
default_ca                     = CA_default

[ CA_default ]
dir                            = /etc/pki/CA
certs                          = $dir/certs
crl_dir                        = $dir/crl
database                       = $dir/db/index.txt
unique_subject                 = yes
new_certs_dir                  = $dir/newcerts
certificate                    = $dir/certs/cws_v4.crt
serial                         = $dir/db/serial
crlnumber                      = $dir/crl/crlnumber
crl                            = $dir/crl/cws_v4.crl
private_key                    = $dir/private/cws_v4.key
RANDFILE                       = $dir/private/.rand
x509_extensions                = usr_cert
name_opt                       = ca_default
cert_opt                       = ca_default
crl_extensions                 = crl_ext
default_days                   = 365
default_crl_days               = 30
default_md                     = aes256
preserve                       = no
policy                         = policy_any

[ policy_match ]
countryName                    = match
stateOrProvinceName            = match
organizationName               = match
organizationalUnitName         = match
commonName                     = match
emailAddress                   = optional

[ req ]
default_bits                   = 2048
default_md                     = aes256
default_keyfile                = privkey.pem
distinguished_name             = req_distinguished_name
#attributes                     = req_attributes
x509_extensions                = v3_ca
string_mask                    = utf8only
req_extensions                 = v3_req

[ req_distinguished_name ]
countryName                    = Country Name (2 letter code)
countryName_default            = US
countryName_min                = 2
countryName_max                = 2
stateOrProvinceName            = State or Province Name (full name)
stateOrProvinceName_default    = New York
localityName                   = Locality Name (eg, city)
localityName_default           = Cheektowaga
0.organizationName             = Organization Name (eg, company)
0.organizationName_default     = CaspersBox Web Services
organizationalUnitName         = Organizational Unit Name (eg, section)
organizationalUnitName_default = Research and Development
commonName                     = Common Name (eg, your name or your servers hostname)
commonName_max                 = 64
commonName_default             = %SITE_HOSTNAME%
emailAddress                   = Email Address
emailAddress_max               = 64
emailAddress_default           = secadm@caspersbox.com

[ req_attributes ]
challengePassword              = A challenge password
challengePassword_min          = 4
challengePassword_max          = 64
unstructuredName               = CaspersBox Web Services

[ server_cert ]
basicConstraints               = CA:FALSE
nsCertType                     = server
keyUsage                       = critical, nonRepudiation, digitalSignature, keyEncipherment, dataEncipherment
extendedKeyUsage               = critical, serverAuth
nsComment                      = "CaspersBox Web Services"
subjectKeyIdentifier           = hash
authorityKeyIdentifier         = keyid,issuer
subjectAltName                 = email:move
issuerAltName                  = issuer:copy
nsCaRevocationUrl              = http://www.caspersbox.com/cws_v4.crl

[ v3_req ]
basicConstraints               = CA:FALSE
keyUsage                       = nonRepudiation, digitalSignature, keyEncipherment, dataEncipherment
subjectKeyIdentifier           = hash
subjectAltName                 = @alt_names

[ alt_names ]
DNS.1                          = *.caspersbox.corp
DNS.2                          = *.caspersbox.com

[ v3_ca ]
subjectKeyIdentifier           = hash
authorityKeyIdentifier         = keyid:always, issuer:always
basicConstraints               = critical, CA:true
keyUsage                       = critical, cRLSign, keyCertSign
extendedKeyUsage               = critical, serverAuth, clientAuth, codeSigning, emailProtection, timeStamping, OCSPSigning, msSGC, nsSGC, msEFS, msSmartcardLogin
nsCertType                     = server, sslCA, emailCA
subjectAltName                 = email:copy
issuerAltName                  = issuer:copy

[ crl_ext ]
issuerAltName                  = issuer:copy
authorityKeyIdentifier         = keyid:always

[ polsect ]
policyIdentifier               = 1.3.5.8
CPS.1                          = "http://www.caspersbox.com/";
userNotice.1                   = @notice

[ notice ]
explicitText                   = "CaspersBox Web Services"
organization                   = "CaspersBox Web Services"
noticeNumbers                  = 1
