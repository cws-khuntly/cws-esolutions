<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <security-config>
        <email-address>secadm@caspersbox.com</email-address>
        <maxAttempts>3</maxAttempts> <!-- maximum number of failed authentication attempts -->
        <iterations>65535</iterations> <!-- number of times to hash over the password -->
        <passwordExpiration>90</passwordExpiration> <!-- how long before a password MUST be changed -->
        <passwordMinLength>8</passwordMinLength> <!--  minimum allowed password length -->
        <passwordMaxLength>64</passwordMaxLength> <!--  maximum allowed password length (0 or null -> no limit)-->
        <authAlgorithm>SHA-512</authAlgorithm> <!-- MessageDigest: http://docs.oracle.com/javase/6/docs/technotes/guides/security/StandardNames.html#MessageDigest -->
        <saltLength>32</saltLength> <!-- salt string length (bigger is better) -->
        <performAudit>true</performAudit> <!-- should we audit stuff ? (default true) -->
        <resetIdLength>64</resetIdLength> <!-- reset id length (bigger is better) -->
        <smsResetEnabled>false</smsResetEnabled> <!-- do we send the reset email AND an sms ? -->
        <smsCodeLength>8</smsCodeLength> <!-- how long should the sms reset id be ? -->
        <resetTimeout>30</resetTimeout> <!-- reset timeout length (minutes) -->
        <authManager>com.cws.esolutions.security.dao.userauth.impl.SQLAuthenticator</authManager>
        <userManager>com.cws.esolutions.security.dao.usermgmt.impl.SQLUserManager</userManager>
    </security-config>

    <auth-data>
        <objectClass>cwsperson</objectClass>
        <userId>uid</userId>
        <userPassword>userPassword</userPassword>
        <lockCount>cwsfailedpwdcount</lockCount>
        <lastLogin>cwslastlogin</lastLogin>
        <surname>sn</surname>
        <givenName>givenName</givenName>
        <expiryDate>cwsexpirydate</expiryDate>
        <secQuestionOne>cwssecq1</secQuestionOne>
        <secQuestionTwo>cwssecq2</secQuestionTwo>
        <secAnswerOne>cwssecans1</secAnswerOne>
        <secAnswerTwo>cwssecans2</secAnswerTwo>
        <emailAddr>email</emailAddr>
        <isSuspended>cwsissuspended</isSuspended>
        <commonName>cn</commonName>
        <olrSetupReq>cwsisolrsetup</olrSetupReq>
        <olrLocked>cwsisolrlocked</olrLocked>
        <displayName>displayName</displayName>
        <tcAccepted>cwsistcaccepted</tcAccepted>
        <publicKey>cwspublickey</publicKey>
        <pagerNumber>pager</pagerNumber>
        <userType>cwsusertype</userType>
        <telephoneNumber>telephoneNumber</telephoneNumber>
        <memberOf>memberOf</memberOf>
    </auth-data>

    <auth-repo>
        <repoType>NONE</repoType>
        <configFile>/opt/cws/eSolutions/etc/repository.properties</configFile>
        <isSecure>isSecure</isSecure>
        <repositoryDriver>repositoryDriver</repositoryDriver>
        <trustStoreFile>trustStoreFile</trustStoreFile>
        <trustStorePass>trustStorePass</trustStorePass>
        <trustStoreType>trustStoreType</trustStoreType>
        <repositoryHost>repositoryHost</repositoryHost>
        <repositoryPort>repositoryPort</repositoryPort>
        <repositoryConnTimeout>repositoryConnTimeout</repositoryConnTimeout>
        <repositoryReadTimeout>repositoryReadTimeout</repositoryReadTimeout>
        <repositoryUser>repositoryUser</repositoryUser>
        <repositoryPass>repositoryPass</repositoryPass>
        <repositorySalt>repositorySalt</repositorySalt>
        <minConnections>minConnections</minConnections>
        <maxConnections>maxConnections</maxConnections>
    </auth-repo>

    <key-config>
        <keyAlgorithm>RSA</keyAlgorithm>
        <keySize>4096</keySize> <!-- if algorithm is DSA, this MUST be 1024: http://docs.oracle.com/javase/6/docs/technotes/guides/security/SunProviders.html -->
        <keyDirectory>/opt/eSolutions/keys</keyDirectory>
        <keyManager>com.cws.esolutions.security.keymgmt.impl.LDAPKeyManager</keyManager>
    </key-config>

    <file-security-config>
        <signatureAlgorithm>SHA1withRSA</signatureAlgorithm>
        <encryptionAlgorithm>RSA</encryptionAlgorithm>
    </file-security-config>

    <exception-config>
        <sendExceptionNotifications>false</sendExceptionNotifications>
    </exception-config>

    <resource-config>
        <DataSourceManager>
            <dsName>SecurityDataSource</dsName>
            <datasource>jdbc:mysql://127.0.0.1/cwssec?autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull</datasource>
            <driver>com.mysql.jdbc.Driver</driver>
            <dsUser>appuser</dsUser>
            <dsPass>TrUqoyr4N3KXK8Ivd9jcZ1fXPy00JRe5xNFiaOEUVQU=</dsPass>
            <salt>OITltocOUZjW</salt>
        </DataSourceManager>
        <DataSourceManager>
            <dsName>AuditDataSource</dsName>
            <datasource>jdbc:mysql://127.0.0.1/cwssec?autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull</datasource>
            <driver>com.mysql.jdbc.Driver</driver>
            <dsUser>appuser</dsUser>
            <dsPass>TrUqoyr4N3KXK8Ivd9jcZ1fXPy00JRe5xNFiaOEUVQU=</dsPass>
            <salt>OITltocOUZjW</salt>
        </DataSourceManager>
    </resource-config>
</configuration>
